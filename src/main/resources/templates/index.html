<!doctype html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="icon" href="https://static.nowcoder.com/images/logo_87_87.png"/>
  <link rel="stylesheet" th:href="@{/css/bootstrap.min.css}">
  <link rel="stylesheet" th:href="@{/css/global.css}"/>
  <title>首页</title>
</head>
<body>
<div class="nk-container">
  <form class="mt-5" method="post" th:action="@{/user/add}" style="align-content: center">
    <div class="form-group row">
      <label for="username" class="col-sm-2 col-form-label text-right">账号:</label>
      <div class="col-sm-10">
        <input type="text" id="username" name="username" placeholder="请输入您的账号!" required>
      </div>
    </div>
    <div class="form-group row mt-4">
      <label for="password" class="col-sm-2 col-form-label text-right">密码:</label>
      <div class="col-sm-10">
        <input type="password" id="password" name="password" placeholder="请输入您的密码!" required>
      </div>
    </div>
    <div class="form-group row mt-4">
      <label for="score" class="col-sm-2 col-form-label text-right">等级:</label>
      <div class="col-sm-10">
        <input type="text" id="score" name="score" placeholder="请输入您的等级!">
      </div>
    </div>
    <div class="form-group row mt-4">
      <div class="col-sm-2"></div>
      <div>
        <button type="submit" >添加</button>
      </div>
    </div>
  </form>
  <form>
    <button style="float: left" onclick="upload()">录入</button>
    <input  style="float: left" multiple="multiple" type="file"  id="uploadFile">
  </form><br>
  <p></p>
  <ul class="list-unstyled" style="align-content: center">
        <li class="media pb-3 pt-3 mb-3 border-bottom" th:each="user:${users}">
          <label for="username" >id:</label>
          <span th:text="${user.id}">张三</span>
          &nbsp;&nbsp;&nbsp;
          <label for="username">username:</label>
          <span th:text="${user.username}">123</span>
          &nbsp;&nbsp;&nbsp;
          <label for="score">等级:</label>
          <span th:text="${user.score}">123</span>
          &nbsp;&nbsp;&nbsp;
          <label for="username"></label>
          <a th:href="@{|/user/delete/${user.id}|}">
            <button type="submit">删除</button>
          </a>
        </li>
      </ul>

  <div class="main">
    <!-- 统计 -->
    <div class="container pl-5 pr-5 pt-3 pb-3 mt-3">
      <h6 class="mt-3"><b class="square"></b> 统计 </h6>
      <form class="form-inline mt-3" method="post" th:action="@{/user/data}">
        <label >姓名:</label>
        <input type="text" class="form-control" id="start" name="start"/>
        <label >等级:</label>
        <input type="text" class="form-control ml-3" id="end" required name="end"/>
        <button type="submit" class="btn btn-primary ml-3">开始统计</button>
      </form>
      <ul class="list-unstyled" style="align-content: center">
        <li class="media pb-3 pt-3 mb-3 border-bottom" th:each="user:${usersList}">
          <label for="username" >id:</label>
          <span th:text="${usersList.id}">张三</span>
          &nbsp;&nbsp;&nbsp;
          <label for="username">username:</label>
          <span th:text="${usersList.username}">123</span>
          &nbsp;&nbsp;&nbsp;
          <label for="score">等级:</label>
          <span th:text="${usersList.score}">123</span>
          &nbsp;&nbsp;&nbsp;
          <label for="username"></label>
          <a th:href="@{|/user/delete/${user.id}|}">
            <button type="submit">删除</button>
          </a>
        </li>
      </ul>
    </div>

<div th:fragment="common-js">
  <script th:src="@{/js/jquery-3.1.0.min.js}"></script>
  <script th:src="@{/js/popper.min.js}"></script>
  <script th:src="@{/js/bootstrap.min.js}"></script>
</div>
<script th:src="@{/js/global.js}"></script>
<script th:src="@{/js/index.js}"></script>
    <script>
      function upload(){
        var formData = new FormData(); //创建一个formData对象实例
        var excelFile = $("#uploadFile").get(0).files[0];
        formData.append("excelFile",excelFile)
        $.ajax({
          url: 'user/userList',
          data: formData,
          type: 'post',
          contentType:false, // 必须false才会自动加上正确的Content-Type
          processData: false, // 必须false才会避开jQuery对 formdata 的默认处理,XMLHttpRequest会对 formdata 进行正确的处理
          success: function (resp){
            console.log(resp);
            // 后续的操作
          }
        })
      }
    </script>

</body>
</html>
